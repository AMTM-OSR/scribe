# this MUST BE the file configured in Skynet as the syslog.log location
# DO NOT use /tmp/syslog.log or /opt/var/log/messages here!
destination d_skynet { 
	file("/opt/var/log/skynet-0.log");
};

# logs everything from Skynet to /opt/var/log/skynet-0.log
filter f_skynet {
    program("Skynet");
};

# Skynet creates a lot of iptables-related log messages,
#   put most of them into /opt/var/log/skynet-0.log
filter f_iptables {
    message("BLOCKED -") or
    message("DROP IN=");
};

# final flag stops processing of messages matching the f_skynet and f_iptables filters
log {
    source(src);
    source(kernel);
    filter(f_skynet);
    filter(f_iptables);
    destination(d_skynet);
    flags(final);
};

#eof
